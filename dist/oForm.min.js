/* oForm - Author: Kyle Rush - MIT license - https://github.com/kylerush/oform */ 
!function(w,d){w.Oform=function(instanceOverrideOptions){var instance,nodeList2Array,mergeObjects,instanceDefaultOptions,elements,i;instance=this,nodeList2Array=function(nodes){for(var n,arr=[],i=0;n=nodes[i];++i)arr.push(n);return arr},instance.on=function(type,cb){return"abort"===type||"error"===type||"load"===type||"loadend"===type||"loadstart"===type||"progress"===type?(instance.options.xhr=instance.options.xhr||{},instance.options.xhr[type]=cb):instance.options[type]=cb,instance},instance.run=function(event){event.preventDefault();var before,invalidFields,inputs,data,returnData;if(invalidFields=0,data=[],returnData={},"function"==typeof instance.options.before?(before=instance.options.before(),void 0===before&&(before=!0)):before=!0,before){inputs=d.querySelectorAll(instance.options.selector+" input"),inputs=nodeList2Array(inputs);var j;for(j=0;j<inputs.length;j++){var item,type,name,value;item=inputs[j],type=item.getAttribute("type"),name=item.getAttribute("name"),value=item.value,returnData[name]=value,item.hasAttribute("required")&&("object"==typeof instance.options.customValidation&&"function"==typeof instance.options.customValidation[name]?instance.options.customValidation[name](item)?instance.options.adjustClasses(item,!0):(instance.options.adjustClasses(item,!1),"function"==typeof instance.options.validationerror&&instance.options.validationerror(item),invalidFields++):instance.options.validate[type](item)?instance.options.adjustClasses(item,!0):(instance.options.adjustClasses(item,!1),"function"==typeof instance.options.validationerror&&instance.options.validationerror(item),invalidFields++)),name&&("checkbox"===type?item.checked&&data.push(name+"="+encodeURIComponent(value)):data.push(name+"="+encodeURIComponent(value)))}data=data.join("&")}if(0===invalidFields&&before)if("string"==typeof instance.options.bodyErrorClass&&instance.options.removeClass(document.getElementsByTagName("body")[0],instance.options.bodyErrorClass),document.querySelector(instance.options.selector).attributes.method&&document.querySelector(instance.options.selector).attributes.method.specified){var request=new XMLHttpRequest;if("object"==typeof instance.options.xhr){var loadFunction=function(event){"function"==typeof instance.options.xhr.load&&instance.options.xhr.load(event,{event:event,data:returnData}),"function"==typeof instance.options.success&&instance.options.success(event,{event:event,data:returnData})};for(var key in instance.options.xhr)"load"===key?"object"==typeof request.onload?request.onload=loadFunction:request.onreadystatechange=function(){4===request.readyState&&loadFunction({target:{responseText:request.responseText}})}:request["on"+key]=instance.options.xhr[key];request.open("POST",event.target.getAttribute("action"),!0),request.timeout&&(request.timeout=0),request.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),"function"==typeof instance.options.middleware&&(data=instance.options.middleware(request,data)),request.send(data)}}else"function"==typeof instance.options.success&&instance.options.success({event:null,data:returnData});else"string"==typeof instance.options.bodyErrorClass&&instance.options.addClass(document.getElementsByTagName("body")[0],instance.options.bodyErrorClass);return"function"==typeof instance.options.done&&instance.options.done(),instance},mergeObjects=function(obj1,obj2){var obj3,attrname;obj3={};for(attrname in obj1)obj3[attrname]=obj1[attrname];for(attrname in obj2)obj3[attrname]=obj2[attrname];return obj3};var validateString=function(element){return"string"==typeof element.value&&element.value?!0:!1};for(instanceDefaultOptions={selector:"form",errorShowClass:"oform-error-show",bodyErrorClass:"oform-error",validate:{email:function(email){var value;value="string"==typeof email?email:email.value;var emailRegEx=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return emailRegEx.test(value)},tel:function(phone){var value;value="string"==typeof phone?phone:phone.value;var phoneOnlyDigits=value.replace(/\D/g,"");return phoneOnlyDigits.length>=10?!0:!1},checkbox:function(checkbox){return checkbox.checked?!0:!1},text:validateString,url:validateString,password:validateString},hasClass:function(ele,cls){return ele.className.match(new RegExp("(\\s|^)"+cls+"(\\s|$)"))},addClass:function(ele,cls){instance.options.hasClass(ele,cls)||(ele.className+=" "+cls)},removeClass:function(ele,cls){if(instance.options.hasClass(ele,cls)){var reg=new RegExp("(\\s|^)"+cls+"(\\s|$)");ele.className=ele.className.replace(reg," ")}},adjustClasses:function(element,isValid){var relatedClass,relatedClasses;if(relatedClass="."+element.getAttribute("name")+"-related",isValid)for(instance.options.removeClass(element,instance.options.errorShowClass),relatedClasses=document.querySelectorAll(instance.options.selector+" "+relatedClass),relatedClasses=nodeList2Array(relatedClasses),i=0;i<relatedClasses.length;i++)instance.options.removeClass(relatedClasses[i],instance.options.errorShowClass);else for(instance.options.addClass(element,instance.options.errorShowClass),relatedClasses=document.querySelectorAll(instance.options.selector+" "+relatedClass),relatedClasses=nodeList2Array(relatedClasses),i=0;i<relatedClasses.length;i++)instance.options.addClass(relatedClasses[i],instance.options.errorShowClass);return isValid}},instance.options=mergeObjects(instanceDefaultOptions,instanceOverrideOptions),elements=d.querySelectorAll(instance.options.selector),elements=nodeList2Array(elements),i=0;i<elements.length;i++)elements[i].addEventListener?elements[i].addEventListener("submit",instance.run,!1):elements[i].attachEvent("onsubmit",instance.run);return instance.remove=function(){var elements;for(elements=d.querySelectorAll(instance.options.selector),elements=nodeList2Array(elements),i=0;i<elements.length;i++)elements[i].removeEventListener?elements[i].removeEventListener("submit",instance.run,!1):elements[i].detachEvent("submit",instance.run);return instance},instance}}(window,document);